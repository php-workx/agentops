#!/bin/bash
# Pre-push hook: Validate plugins before pushing
# Install: git config core.hooksPath .githooks
#
# This runs the same validation that CI will run, so you catch
# issues locally before they fail in the pipeline.

set -e

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
REPO_ROOT="$(cd "$SCRIPT_DIR/.." && pwd)"

echo ""
echo "üîç Running pre-push plugin validation..."
echo ""

# Run local validation
if ! "$REPO_ROOT/scripts/validate-local.sh"; then
    echo ""
    echo "‚ùå Pre-push validation failed!"
    echo ""
    echo "Fix the issues above before pushing."
    echo "To bypass (not recommended): git push --no-verify"
    echo ""
    exit 1
fi

echo ""
echo "‚úÖ Pre-push validation passed"
echo ""
